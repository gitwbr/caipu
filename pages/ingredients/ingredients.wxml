<view class="container">
  <!-- æœç´¢æ  -->
  <view class="search-bar">
    <view class="search-input-container">
      <input 
        class="search-input" 
        placeholder="æœç´¢é£Ÿç‰©åç§°..." 
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
      />
      <view class="search-icon">ğŸ”</view>
      <view wx:if="{{searchKeyword}}" class="clear-btn" bindtap="clearSearch">âœ•</view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading">
    <text>æœç´¢ä¸­...</text>
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:if="{{showSearchResults && searchResults.length > 0}}" class="search-results">
    <view class="results-header">
      <text>æœç´¢ç»“æœ ({{searchResults.length}})</text>
    </view>
    <view class="food-list">
      <view 
        wx:for="{{searchResults}}" 
        wx:key="id" 
        class="food-item"
        bindtap="selectFood"
        data-food="{{item}}"
      >
        <view class="food-name">{{item.food_name}}</view>
        <view class="food-nutrition">
          <text>èƒ½é‡: {{item.energy_kcal}}kcal</text>
          <text>è›‹ç™½è´¨: {{item.protein_g}}g</text>
          <text>è„‚è‚ª: {{item.fat_g}}g</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ— æœç´¢ç»“æœ -->
  <view wx:if="{{showSearchResults && searchResults.length === 0 && !isLoading}}" class="no-results">
    <text>æœªæ‰¾åˆ°ç›¸å…³é£Ÿç‰©</text>
  </view>

  <!-- é£Ÿç‰©è¯¦æƒ…å¼¹çª— -->
  <view wx:if="{{showFoodDetail && selectedFood}}" class="food-detail-modal">
    <view class="modal-overlay" bindtap="closeFoodDetail"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">{{selectedFood.food_name}}</text>
        <view class="close-btn" bindtap="closeFoodDetail">âœ•</view>
      </view>
      
      <scroll-view class="modal-body" scroll-y>
        <view class="nutrition-section">
          <view class="section-title">åŸºæœ¬ä¿¡æ¯</view>
          <view class="nutrition-grid">
            <view class="nutrition-item">
              <text class="label">å¯é£Ÿéƒ¨åˆ†</text>
              <text class="value">{{selectedFood.edible_pct}}%</text>
            </view>
            <view class="nutrition-item">
              <text class="label">èƒ½é‡</text>
              <text class="value">{{selectedFood.energy_kcal}} kcal</text>
            </view>
            <view class="nutrition-item">
              <text class="label">æ°´åˆ†</text>
              <text class="value">{{formatNutritionValue(selectedFood.moisture_g, 'g')}}</text>
            </view>
          </view>
        </view>

        <view class="nutrition-section">
          <view class="section-title">å®é‡è¥å…»ç´ </view>
          <view class="nutrition-grid">
            <view class="nutrition-item">
              <text class="label">è›‹ç™½è´¨</text>
              <text class="value">{{formatNutritionValue(selectedFood.protein_g, 'g')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">è„‚è‚ª</text>
              <text class="value">{{formatNutritionValue(selectedFood.fat_g, 'g')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç¢³æ°´åŒ–åˆç‰©</text>
              <text class="value">{{formatNutritionValue(selectedFood.carbohydrate_g, 'g')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">è†³é£Ÿçº¤ç»´</text>
              <text class="value">{{formatNutritionValue(selectedFood.fiber_g, 'g')}}</text>
            </view>
          </view>
        </view>

        <view class="nutrition-section">
          <view class="section-title">ç»´ç”Ÿç´ </view>
          <view class="nutrition-grid">
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ A</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_a_ug, 'Î¼g')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ Bâ‚</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_b1_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ Bâ‚‚</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_b2_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ Bâ‚ƒ</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_b3_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ C</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_c_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">ç»´ç”Ÿç´ E</text>
              <text class="value">{{formatNutritionValue(selectedFood.vitamin_e_mg, 'mg')}}</text>
            </view>
          </view>
        </view>

        <view class="nutrition-section">
          <view class="section-title">çŸ¿ç‰©è´¨</view>
          <view class="nutrition-grid">
            <view class="nutrition-item">
              <text class="label">é’™</text>
              <text class="value">{{formatNutritionValue(selectedFood.ca_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">é“</text>
              <text class="value">{{formatNutritionValue(selectedFood.fe_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">é’ </text>
              <text class="value">{{formatNutritionValue(selectedFood.na_mg, 'mg')}}</text>
            </view>
            <view class="nutrition-item">
              <text class="label">èƒ†å›ºé†‡</text>
              <text class="value">{{formatNutritionValue(selectedFood.cholesterol_mg, 'mg')}}</text>
            </view>
          </view>
        </view>
      </scroll-view>
    </view>
  </view>

  <!-- é»˜è®¤æç¤º -->
  <view wx:if="{{!showSearchResults && !showFoodDetail}}" class="default-tip">
    <text>åœ¨æœç´¢æ¡†ä¸­è¾“å…¥é£Ÿç‰©åç§°å¼€å§‹æœç´¢</text>
    <text>æ•°æ®æ¥æºï¼šä¸­å›½å¸¸è§é£Ÿå“è¥å…»æˆåˆ†è¡¨</text>
  </view>
</view> 