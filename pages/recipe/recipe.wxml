<view class="page">
  <!-- èœè°±å¤´éƒ¨ -->
  <view class="recipe-header">
    <view class="recipe-title">{{recipe.name}}</view>
    <view class="recipe-desc">{{recipe.description}}</view>
    <view class="recipe-tags">
      <view class="tag" wx:for="{{recipe.tags}}" wx:key="index">{{item}}</view>
    </view>
  </view>

  <!-- æ”¶è—æŒ‰é’® -->
  <view class="favorite-btn {{isFavorite ? 'favorited' : ''}}" bindtap="toggleFavorite">
    <view class="favorite-icon">
      {{isFavorite ? 'â¤ï¸' : 'ğŸ¤'}}
    </view>
    <text class="favorite-text">{{isFavorite ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
  </view>

  <!-- è¥å…»ä¿¡æ¯ -->
  <view class="card">
    <view class="card-title">è¥å…»ä¿¡æ¯</view>
    <view class="nutrition-grid">
      <view class="nutrition-item">
        <view class="nutrition-value">{{recipe.nutrition.calories}}</view>
        <view class="nutrition-label">çƒ­é‡(åƒå¡)</view>
      </view>
      <view class="nutrition-item">
        <view class="nutrition-value">{{recipe.nutrition.protein}}</view>
        <view class="nutrition-label">è›‹ç™½è´¨(g)</view>
      </view>
      <view class="nutrition-item">
        <view class="nutrition-value">{{recipe.nutrition.fat}}</view>
        <view class="nutrition-label">è„‚è‚ª(g)</view>
      </view>
      <view class="nutrition-item">
        <view class="nutrition-value">{{recipe.nutrition.carbs}}</view>
        <view class="nutrition-label">ç¢³æ°´åŒ–åˆç‰©(g)</view>
      </view>
    </view>
  </view>

  <!-- é£Ÿææ¸…å• -->
  <view class="card">
    <view class="card-title">é£Ÿææ¸…å•ï¼ˆå¯ä¿®æ”¹ç”¨é‡ï¼‰</view>
    <view class="ingredients-list">
      <view 
        wx:for="{{recipe.ingredients}}" 
        wx:key="index"
        class="ingredient-item-card"
      >
        <view class="ingredient-main">
          <view class="ingredient-name">{{item.name}}</view>
          <view class="ingredient-input-group">
            <input 
              type="number" 
              value="{{item.weight}}"
              data-index="{{index}}"
              bindinput="updateIngredientWeight"
              class="weight-input"
            />
            <text class="unit-text">{{item.unitNormalized || 'g'}}</text>
          </view>
        </view>
        <view class="ingredient-nutrition-grid">
          <view class="nutrition-cell">
            <view class="nutrition-value-small">{{item.nutritionInfo.calories}}</view>
            <view class="nutrition-label-small">çƒ­é‡(åƒå¡)</view>
          </view>
          <view class="nutrition-cell">
            <view class="nutrition-value-small">{{item.nutritionInfo.protein}}</view>
            <view class="nutrition-label-small">è›‹ç™½è´¨(g)</view>
          </view>
          <view class="nutrition-cell">
            <view class="nutrition-value-small">{{item.nutritionInfo.fat}}</view>
            <view class="nutrition-label-small">è„‚è‚ª(g)</view>
          </view>
          <view class="nutrition-cell">
            <view class="nutrition-value-small">{{item.nutritionInfo.carbohydrates || item.nutritionInfo.carbs}}</view>
            <view class="nutrition-label-small">ç¢³æ°´(g)</view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="card">
    <view class="card-title">åˆ¶ä½œæ­¥éª¤</view>
    <view class="steps-list">
      <view 
        wx:for="{{recipe.steps}}" 
        wx:key="index"
        class="step-item"
      >
        <view class="step-number">{{index + 1}}</view>
        <view class="step-content">{{item}}</view>
      </view>
    </view>
  </view>

  <!-- çƒ¹é¥ªæŠ€å·§ -->
  <view class="card" wx:if="{{recipe.tips}}">
    <view class="card-title">çƒ¹é¥ªæŠ€å·§</view>
    <view class="tips-content">{{recipe.tips}}</view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-primary" bindtap="shareRecipe">åˆ†äº«èœè°±</button>
    <button class="btn-secondary" wx:if="{{fromFavorites}}" bindtap="updateFavoriteRecipe">æ›´æ–°</button>
    <button class="btn-secondary" wx:else bindtap="toggleFavorite">{{isFavorite ? 'å–æ¶ˆæ”¶è—' : 'æ”¶è—'}}</button>
  </view>
</view> 