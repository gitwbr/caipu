<!--pages/record/add-custom-food.wxml-->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ï¼ˆç§»é™¤å ä½ï¼‰ -->
  

  <!-- è¡¨å•å†…å®¹ -->
  <scroll-view class="form-container" scroll-y="true">
    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <view class="form-section">
      <view class="section-bar">
        <view class="section-left">
          <view class="section-title">ğŸ½ï¸ åŸºæœ¬ä¿¡æ¯</view>
          
        </view>
        <button class="icon-btn clear-icon" aria-label="æ¸…ç©º" bindtap="onClear" style="position: relative; left: 236rpx; top: -9rpx; width: 130rpx; display: block; box-sizing: border-box">Ã—</button>
      </view>
      
      <view class="form-item">
        <text class="label required">é£Ÿç‰©åç§°</text>
        <input 
          class="input" 
          placeholder="è¯·è¾“å…¥é£Ÿç‰©åç§°" 
          value="{{food_name}}"
          data-field="food_name"
          bindinput="onInputChange"
        />
      </view>
      
      <view class="form-item">
        <text class="label required">èƒ½é‡</text>
        <view class="energy-input-group">
          <input 
            class="input energy-input" 
            type="digit" 
            placeholder="è¯·è¾“å…¥èƒ½é‡å€¼" 
            value="{{energy_value}}"
            data-field="energy_value"
            bindinput="onInputChange"
          />
          <picker 
            class="unit-picker" 
            range="{{energy_units}}" 
            value="{{energy_unit_index}}"
            bindchange="onEnergyUnitChange"
          >
            <view class="picker-text">{{energy_units[energy_unit_index]}}</view>
          </picker>
        </view>
        <text class="unit-hint">/100g</text>
      </view>

      <!-- å›¾ç‰‡ä¸Šä¼ ï¼ˆè¡Œå†…ï¼šå·¦ä¾§æ ‡é¢˜ï¼Œå³ä¾§ç›¸æœº/ç¼©ç•¥å›¾ï¼‰ -->
      <view class="form-item image-inline">
        <text class="label">é£Ÿç‰©å›¾ç‰‡</text>
        <view class="camera-slot">
          <view wx:if="{{!(imagePath || imageUrl)}}" class="camera-btn" bindtap="onCameraClick">
            <text class="camera-icon">ğŸ“·</text>
          </view>
          <view wx:else class="thumb-wrap">
            <image class="thumb" src="{{imagePath || imageUrl}}" mode="aspectFill" bindtap="previewImage" />
            <view class="remove-thumb" bindtap="removeImage">âˆ’</view>
          </view>
        </view>
      </view>
    </view>

    <!-- å®é‡è¥å…»ç´  -->
    <view class="form-section">
      <view class="section-title">ğŸ¥‘ å®é‡è¥å…»ç´  (g/100g)</view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">è›‹ç™½è´¨</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{protein_g}}"
            data-field="protein_g"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">è„‚è‚ª</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{fat_g}}"
            data-field="fat_g"
            bindinput="onInputChange"
          />
        </view>
      </view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">ç¢³æ°´åŒ–åˆç‰©</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{carbohydrate_g}}"
            data-field="carbohydrate_g"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">è†³é£Ÿçº¤ç»´</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{fiber_g}}"
            data-field="fiber_g"
            bindinput="onInputChange"
          />
        </view>
      </view>
      
      <view class="form-item">
        <text class="label">æ°´åˆ†</text>
        <input 
          class="input" 
          type="digit" 
          placeholder="0.0" 
          value="{{moisture_g}}"
          data-field="moisture_g"
          bindinput="onInputChange"
        />
      </view>
    </view>

    <!-- ç»´ç”Ÿç´  -->
    <view class="form-section">
      <view class="section-title">ğŸŠ ç»´ç”Ÿç´ </view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ A (Âµg RAE)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_a_ug}}"
            data-field="vitamin_a_ug"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ C (mg)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_c_mg}}"
            data-field="vitamin_c_mg"
            bindinput="onInputChange"
          />
        </view>
      </view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ Bâ‚ (mg)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_b1_mg}}"
            data-field="vitamin_b1_mg"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ Bâ‚‚ (mg)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_b2_mg}}"
            data-field="vitamin_b2_mg"
            bindinput="onInputChange"
          />
        </view>
      </view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ Bâ‚ƒ (mg)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_b3_mg}}"
            data-field="vitamin_b3_mg"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">ç»´ç”Ÿç´ E (mg)</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{vitamin_e_mg}}"
            data-field="vitamin_e_mg"
            bindinput="onInputChange"
          />
        </view>
      </view>
    </view>

    <!-- çŸ¿ç‰©è´¨ -->
    <view class="form-section">
      <view class="section-title">ğŸ§‚ çŸ¿ç‰©è´¨ (mg/100g)</view>
      
      <view class="form-row">
        <view class="form-item half">
          <text class="label">é’ </text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{na_mg}}"
            data-field="na_mg"
            bindinput="onInputChange"
          />
        </view>
        
        <view class="form-item half">
          <text class="label">é’™</text>
          <input 
            class="input" 
            type="digit" 
            placeholder="0.0" 
            value="{{ca_mg}}"
            data-field="ca_mg"
            bindinput="onInputChange"
          />
        </view>
      </view>
      
      <view class="form-item">
        <text class="label">é“</text>
        <input 
          class="input" 
          type="digit" 
          placeholder="0.0" 
          value="{{fe_mg}}"
          data-field="fe_mg"
          bindinput="onInputChange"
        />
      </view>
    </view>

    <!-- å…¶ä»– -->
    <view class="form-section">
      <view class="section-title">ğŸ§ª å…¶ä»–</view>
      
      <view class="form-item">
        <text class="label">èƒ†å›ºé†‡ (mg/100g)</text>
        <input 
          class="input" 
          type="digit" 
          placeholder="0.0" 
          value="{{cholesterol_mg}}"
          data-field="cholesterol_mg"
          bindinput="onInputChange"
        />
      </view>
    </view>

    <!-- åº•éƒ¨é—´è· -->
    <view class="bottom-spacing"></view>
  </scroll-view>

  <!-- åº•éƒ¨æŒ‰é’® -->
  <view class="bottom-actions">
    <button 
      class="submit-btn {{submitting ? 'loading' : ''}}" 
      bindtap="onSubmit"
      disabled="{{submitting}}"
    >
      {{submitting ? ((isEditMode && food_id) ? 'æ›´æ–°ä¸­...' : 'æ·»åŠ ä¸­...') : ((isEditMode && food_id) ? 'æ›´æ–°é£Ÿç‰©' : 'æ·»åŠ é£Ÿç‰©')}}
    </button>
  </view>
</view> 