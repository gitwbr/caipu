<!-- pages/profile/profile.wxml -->
<view class="container">

  <!-- 顶部信息卡（可点击） -->
  <view class="top-card" bindtap="goEdit">
    <view class="top-card__upper">
      <image class="avatar" src="{{localAvatar || '/images/profile.png'}}" mode="aspectFill"></image>
      <view class="namebox {{ (isLoggedIn && userInfo && userInfo.phone) ? '' : 'namebox--single' }}">
        <text class="nickname">
          {{ !isLoggedIn ? '未登录' : (userInfo.nickname || '微信用户') }}
        </text>
        <text class="uid" wx:if="{{isLoggedIn && userInfo && userInfo.phone}}">
          {{ userInfo.phone }}
        </text>
      </view>
    </view>

    <!-- 分割线 -->
    <view class="split-line">
      <view class="split-dot"></view>
      <view class="split-hr"></view>
      <view class="split-dot"></view>
    </view>

    <view class="top-card__lower">
      <view class="metric">
        <text class="metric-label">体重</text>
        <text class="metric-value">{{ userInfo.weight_kg || '--' }}<text class="unit">kg</text></text>
      </view>
      <view class="metric">
        <text class="metric-label">BMI</text>
        <text class="metric-value">{{ bmi || '--' }}</text>
      </view>
      <view class="metric">
        <text class="metric-label">BMR</text>
        <text class="metric-value">{{ bmr || '--' }}<text class="unit">kcal/天</text></text>
      </view>
    </view>
  </view>



  <!-- 功能卡片宫格（图片风格） -->
  <view class="grid-cards">
    <view class="grid-card" hover-class="grid-card--hover" bindtap="goEdit">
      <image class="grid-bg" src="/images/profile/card-basic.png" mode="aspectFill"></image>
      <view class="grid-mask"></view>
      <view class="grid-title">基本信息</view>
    </view>

    <view class="grid-card" hover-class="grid-card--hover" bindtap="goFavorites">
      <image class="grid-bg" src="/images/profile/card-fav.png" mode="aspectFill"></image>
      <view class="grid-mask"></view>
      <view class="grid-title">收藏的菜谱</view>
    </view>
  </view>

  <!-- 设置列表 -->
  <view class="menu-list">
    <view class="menu-item" bindtap="goHelp">
      <image class="menu-icon" src="/images/profile/help-color.png" mode="widthFix"></image>
      <text class="menu-text">帮助与反馈</text>
      <text class="arrow">›</text>
    </view>

    <view class="menu-item" bindtap="goAbout">
      <image class="menu-icon" src="/images/profile/about-color.png" mode="widthFix"></image>
      <text class="menu-text">关于我们</text>
      <text class="arrow">›</text>
    </view>

     <view class="menu-item" bindtap="handleLogout" wx:if="{{isLoggedIn}}">
       <image class="menu-icon" src="/images/profile/logout-color.png" mode="widthFix"></image>
       <text class="menu-text">退出登录</text>
       <text class="arrow">›</text>
     </view>
  </view>

</view>
